<ng-container *ngIf="registrationCompleted; else accountForm">
    <ng-content select="[registrationCompletedPresentment]"></ng-content>
</ng-container>
<ng-template #accountForm>
    <ng-content select="[registrationFormHeader]"></ng-content>
    <p *ngIf="registerObject?.email" qatag="RegisterText">
        {{ registerObject.email }}
    </p>
    <br />
    <form *ngIf="registerFg" [formGroup]="registerFg" class="register-account-form" (ngSubmit)="registerFormSubmit()" #paymentFormRef="ngForm" novalidate>
        <div class="row no-padding" *ngIf="!registerObject?.email">
            <div class="column small-12 no-padding">
                <div class="input-container" [class.invalid]="controlIsInvalid(registerFgControls.userName)">
                    <label for="regActUserName">{{ translatePrefixKey + "REGISTER_FORM.USERNAME.LABEL" | translate }}</label>
                    <input id="regActUserName" formControlName="userName" type="text" onFocus />
                </div>
                <div *ngIf="controlIsInvalid(registerFgControls.userName)" class="invalid-feedback">
                    <p *ngIf="registerFgControls.userName.errors.required">{{ translatePrefixKey + "REGISTER_FORM.USERNAME.ERRORS.REQUIRED" | translate }}</p>
                    <p *ngIf="registerFgControls.userName.errors.usernameInUse">
                        {{ translatePrefixKey + "REGISTER_FORM.USERNAME.ERRORS.USERNAME_IN_USE" | translate }}
                    </p>
                    <p *ngIf="registerFgControls.userName.errors.invalidUsername">
                        {{ translatePrefixKey + "REGISTER_FORM.USERNAME.ERRORS.INVALID_USERNAME" | translate }}
                    </p>
                    <p *ngIf="registerFgControls.userName.errors.pattern">{{ translatePrefixKey + "REGISTER_FORM.USERNAME.ERRORS.PATTERN" | translate }}</p>
                </div>
            </div>
        </div>
        <div class="row no-padding" *ngIf="credentialState.showPassword && registerFg.contains('password')">
            <div class="column small-12 no-padding">
                <sxm-ui-password-strength
                    formControlName="password"
                    [labelText]="
                        'DomainsIdentificationUiSetupRegistrationCredentialsFormModule.SetupRegistrationCredentialsComponent.REGISTER_FORM.PASSWORD.LABEL' | translate
                    "
                    qatagName="RegisterPassword"
                    id="regActPass"
                    [reservedWords]="reservedWords"
                    [passwordGenericError]="passwordGenericError"
                    [alwaysDisplayPasswordHint]="false"
                    [hidePasswordHintFeature]="true"
                    [class.invalid]="controlIsInvalid(registerFgControls.password)"
                    #passwordComponentRef
                ></sxm-ui-password-strength>
                <div *ngIf="(passwordStrengthEventsHaveEvaluated$ | async) !== -1 && controlIsInvalid(registerFgControls.password)" class="invalid-feedback">
                    <p *ngIf="registerFgControls.password.hasError('required')">
                        {{ translatePrefixKey + "REGISTER_FORM.PASSWORD.ERRORS.REQUIRED" | translate }}
                    </p>
                    <p *ngIf="registerFgControls.password.hasError('length')">
                        {{ translatePrefixKey + "REGISTER_FORM.PASSWORD.ERRORS.LENGTH" | translate: registerFgControls.password.errors.length }}
                    </p>
                    <p *ngIf="registerFgControls.password.hasError('policy')">
                        {{ translatePrefixKey + "REGISTER_FORM.PASSWORD.ERRORS.POLICY" | translate }}
                    </p>
                    <p *ngIf="registerFgControls.password.hasError('generic')">
                        {{ translatePrefixKey + "REGISTER_FORM.PASSWORD.ERRORS.GENERIC" | translate }}
                    </p>
                    <p *ngIf="registerFgControls.password.errors?.reservedWords as reservedWordsError">
                        {{
                            translatePrefixKey + "REGISTER_FORM.PASSWORD.ERRORS.RESERVED_WORDS"
                                | translate
                                    : {
                                          pluralWord: reservedWordsError.words.length | i18nPlural: (translatePrefixKey + "PLURAL_MAP.WORD" | translate),
                                          reservedWords: reservedWordsError.words.join(", ")
                                      }
                        }}
                    </p>
                </div>
            </div>
        </div>
        <ng-container *ngIf="displaysecurityQuestions">
            <div class="row register-account-subheader no-padding" data-e2e="setupRegistrationCredentialsComponent.securityQuestions">
                <div class="column small-12 align-left text-color-gray-dark no-padding">
                    <p qatag="RegisterSecurityQSubheader">
                        <b>{{ translatePrefixKey + "REGISTER_FORM.SECURITY_QUESTIONS.HEADER" | translate }}</b>
                    </p>
                </div>
            </div>
            <div class="row no-padding">
                <div class="column small-12 no-padding">
                    <sxm-ui-dropdown
                        [filterSelected]="true"
                        [passedValue]="registerObject.security | recoverPasswordQuestions: registerFgControls.question1.value:registerFgControls.question2.value"
                        text="question"
                        key="id"
                        class="dropdown"
                        [labelText]="
                            'DomainsIdentificationUiSetupRegistrationCredentialsFormModule.SetupRegistrationCredentialsComponent.REGISTER_FORM.SECURITY_QUESTIONS.LABEL'
                                | translate
                        "
                        tabindex="0"
                        formControlName="question0"
                        qatag="RegisterQ1"
                        [class.invalid]="controlIsInvalid(registerFgControls.question0)"
                    >
                    </sxm-ui-dropdown>
                    <div *ngIf="controlIsInvalid(registerFgControls.question0)" class="invalid-feedback">
                        <p *ngIf="registerFgControls.question0.errors.required">
                            {{ translatePrefixKey + "REGISTER_FORM.SECURITY_QUESTIONS.ERRORS.SELECT_A_QUESTION" | translate }}
                        </p>
                    </div>
                </div>
            </div>
            <div class="row no-padding">
                <div class="column small-12 no-padding">
                    <div class="input-container" [class.invalid]="controlIsInvalid(registerFgControls.answer0)" qatag="RegisterA1" data-test="securityQuestionAnswer1">
                        <label for="regActSecAnswer0">{{ translatePrefixKey + "REGISTER_FORM.SECURITY_QUESTIONS.ANSWER" | translate }}</label>
                        <input id="regActSecAnswer0" formControlName="answer0" type="text" minlength="3" onFocus />
                    </div>
                    <div *ngIf="controlIsInvalid(registerFgControls.answer0)" class="invalid-feedback">
                        <p *ngIf="registerFgControls.answer0.errors.required">
                            {{ translatePrefixKey + "REGISTER_FORM.SECURITY_QUESTIONS.ERRORS.REQUIRED" | translate }}
                        </p>
                        <p *ngIf="registerFgControls.answer0.errors.minlength">
                            {{ translatePrefixKey + "REGISTER_FORM.SECURITY_QUESTIONS.ERRORS.MIN_LENGTH" | translate }}
                        </p>
                    </div>
                </div>
            </div>
            <div class="row no-padding">
                <div class="column small-12 no-padding">
                    <sxm-ui-dropdown
                        [filterSelected]="true"
                        [passedValue]="registerObject.security | recoverPasswordQuestions: registerFgControls.question0.value:registerFgControls.question2.value"
                        text="question"
                        key="id"
                        class="dropdown"
                        [labelText]="
                            'DomainsIdentificationUiSetupRegistrationCredentialsFormModule.SetupRegistrationCredentialsComponent.REGISTER_FORM.SECURITY_QUESTIONS.LABEL'
                                | translate
                        "
                        tabindex="0"
                        formControlName="question1"
                        qatag="RegisterQ2"
                        [class.invalid]="controlIsInvalid(registerFgControls.question1)"
                    >
                    </sxm-ui-dropdown>
                    <div *ngIf="controlIsInvalid(registerFgControls.question1)" class="invalid-feedback">
                        <p *ngIf="registerFgControls.question1.errors.required">
                            {{ translatePrefixKey + "REGISTER_FORM.SECURITY_QUESTIONS.ERRORS.SELECT_A_QUESTION" | translate }}
                        </p>
                    </div>
                </div>
            </div>
            <div class="row no-padding">
                <div class="column small-12 no-padding">
                    <div class="input-container" [class.invalid]="controlIsInvalid(registerFgControls.answer1)" qatag="RegisterA2" data-test="securityQuestionAnswer2">
                        <label for="regActSecAnswer1">{{ translatePrefixKey + "REGISTER_FORM.SECURITY_QUESTIONS.ANSWER" | translate }}</label>
                        <input id="regActSecAnswer1" formControlName="answer1" type="text" minlength="3" onFocus />
                    </div>
                    <div *ngIf="controlIsInvalid(registerFgControls.answer1)" class="invalid-feedback">
                        <p *ngIf="registerFgControls.answer1.errors.required">
                            {{ translatePrefixKey + "REGISTER_FORM.SECURITY_QUESTIONS.ERRORS.REQUIRED" | translate }}
                        </p>
                        <p *ngIf="registerFgControls.answer1.errors.minlength">
                            {{ translatePrefixKey + "REGISTER_FORM.SECURITY_QUESTIONS.ERRORS.MIN_LENGTH" | translate }}
                        </p>
                    </div>
                </div>
            </div>
            <div class="row no-padding">
                <div class="column small-12 no-padding">
                    <sxm-ui-dropdown
                        [class.invalid]="controlIsInvalid(registerFgControls.question2)"
                        [filterSelected]="true"
                        [passedValue]="registerObject.security | recoverPasswordQuestions: registerFgControls.question0.value:registerFgControls.question1.value"
                        text="question"
                        key="id"
                        class="dropdown"
                        [labelText]="
                            'DomainsIdentificationUiSetupRegistrationCredentialsFormModule.SetupRegistrationCredentialsComponent.REGISTER_FORM.SECURITY_QUESTIONS.LABEL'
                                | translate
                        "
                        tabindex="0"
                        formControlName="question2"
                        qatag="RegisterQ3"
                    >
                    </sxm-ui-dropdown>
                    <div *ngIf="controlIsInvalid(registerFgControls.question2)" class="invalid-feedback">
                        <p *ngIf="registerFgControls.question2.errors.required">
                            {{ translatePrefixKey + "REGISTER_FORM.SECURITY_QUESTIONS.ERRORS.SELECT_A_QUESTION" | translate }}
                        </p>
                    </div>
                </div>
            </div>
            <div class="row no-padding">
                <div class="column small-12 no-padding">
                    <div class="input-container" [class.invalid]="controlIsInvalid(registerFgControls.answer2)" qatag="RegisterA3" data-test="securityQuestionAnswer3">
                        <label for="regActSecAnswer2">{{ translatePrefixKey + "REGISTER_FORM.SECURITY_QUESTIONS.ANSWER" | translate }}</label>
                        <input id="regActSecAnswer2" formControlName="answer2" type="text" minlength="3" onFocus />
                    </div>
                    <div *ngIf="controlIsInvalid(registerFgControls.answer2)" class="invalid-feedback">
                        <p *ngIf="registerFgControls.answer2.errors.required">
                            {{ translatePrefixKey + "REGISTER_FORM.SECURITY_QUESTIONS.ERRORS.REQUIRED" | translate }}
                        </p>
                        <p *ngIf="registerFgControls.answer2.errors.minlength">
                            {{ translatePrefixKey + "REGISTER_FORM.SECURITY_QUESTIONS.ERRORS.MIN_LENGTH" | translate }}
                        </p>
                    </div>
                </div>
            </div>
        </ng-container>
    </form>
    <br />
    <div class="row no-padding">
        <div class="column small-12 align-left no-padding">
            <a
                class="text-link privacy-policy"
                href="{{ 'DomainsIdentificationUiSetupRegistrationCredentialsFormModule.SetupRegistrationCredentialsComponent.PRIVACY_POLICY.LINK_URL' | translate }}"
                target="_blank"
            >
                {{ translatePrefixKey + "PRIVACY_POLICY.LINK_TEXT" | translate }}
            </a>
        </div>
    </div>
    <div class="row align-center no-padding">
        <div class="column small-12 no-padding">
            <button
                class="button-margin"
                type="submit"
                qatag="RegisterButton"
                [loading]="isProcessingRegistration$ | async"
                sxm-proceed-button
                (click)="registerFormContinue()"
                (mouseenter)="isMouseInSubmitButtonZone$.next('ENTERED')"
                (mouseleave)="isMouseInSubmitButtonZone$.next('LEFT')"
                #registerButtonRef
            >
                {{ translatePrefixKey + "REGISTER" | translate }}
            </button>
        </div>
    </div>
</ng-template>
