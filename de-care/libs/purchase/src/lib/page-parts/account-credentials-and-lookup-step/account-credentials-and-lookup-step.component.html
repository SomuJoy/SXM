<p class="description">{{ translateKeyPrefix + ".EMAIL_DESCRIPTION" | translate }}</p>
<form [formGroup]="form" sxmUiForceUpdateFormFieldOnEnterKey (ngSubmit)="onSubmit()">
    <div class="row no-padding">
        <div class="column small-12 no-padding align-left">
            <div
                class="input-container"
                [class.invalid]="(form.controls.email | formControlInvalid: submitted) || emailServiceErrors"
                [class.filled]="form.controls.email.value"
            >
                <label for="email">{{ translateKeyPrefix + ".EMAIL_PLACEHOLDER" | translate }}</label>
                <input type="text" appTrimFormField formControlName="email" id="email" onFocus required maxlength="250" data-e2e="accountLookup.emailField" />
            </div>
            <div *ngIf="(form.controls.email | formControlInvalid: submitted) || emailServiceErrors" class="invalid-feedback">
                <p *ngIf="form.controls.email.hasError('usernameInUse'); else generalEmailError">
                    {{ translateKeyPrefix + ".EMAIL_IN_USE_ERROR_MSG" | translate }}
                </p>
                <ng-template #generalEmailError>
                    <p>{{ translateKeyPrefix + ".EMAIL_INVALID_MSG" | translate }}</p>
                </ng-template>
            </div>
        </div>
    </div>
    <sxm-ui-password-strength
        formControlName="password"
        [labelText]="translateKeyPrefix + '.PASSWORD.LABEL' | translate"
        [reservedWords]="reservedWords"
        [class.invalid]="form.controls.password | formControlInvalid: submitted"
        [alwaysDisplayPasswordHint]="alwaysDisplayPasswordHint"
        #passwordFormField
    ></sxm-ui-password-strength>
    <div *ngIf="form.controls.password | formControlInvalid: submitted" class="invalid-feedback">
        <p *ngIf="form.controls.password.hasError('required')">
            {{ translateKeyPrefix + ".PASSWORD.ERRORS.REQUIRED" | translate }}
        </p>
        <p *ngIf="form.controls.password.hasError('length')">
            {{ translateKeyPrefix + ".PASSWORD.ERRORS.LENGTH" | translate: form.controls.password.errors.length }}
        </p>
        <p *ngIf="form.controls.password.hasError('policy')">
            {{ translateKeyPrefix + ".PASSWORD.ERRORS.POLICY" | translate }}
        </p>
        <p *ngIf="form.controls.password.hasError('generic')">
            {{ translateKeyPrefix + ".PASSWORD.ERRORS.GENERIC" | translate }}
        </p>
        <p *ngIf="form.controls.password.hasError('piiData')">
            {{ translateKeyPrefix + ".PASSWORD.ERRORS.PII_DATA" | translate }}
        </p>
        <p *ngIf="form.controls.password.errors?.reservedWords as reservedWordsError">
            {{
                translateKeyPrefix + ".PASSWORD.ERRORS.RESERVED_WORDS"
                    | translate
                        : {
                              pluralWord: reservedWordsError.words.length | i18nPlural: (translateKeyPrefix + ".PLURAL_MAP.WORD" | translate),
                              reservedWords: reservedWordsError.words.join(", ")
                          }
            }}
        </p>
    </div>
    <privacy-policy></privacy-policy>
    <button
        sxm-proceed-button
        [loading]="isLoading"
        data-e2e="accountLookup.lookupButton"
        (mouseenter)="mouseEnterOnContinueButton()"
        (mouseleave)="mouseLeaveOnContinueButton()"
    >
        {{ translateKeyPrefix + ".BUTTON_LABEL" | translate }}
    </button>
</form>

<sxm-ui-modal #accountFoundModal (modalClosed)="onAccountFoundModalClose()" [title]="translateKeyPrefix + '.ACCOUNT_FOUND_MODAL_TITLE' | translate" [titlePresent]="true" [ariaDescribedbyTextId]="accountCredentialsyourSubsModalAriaDescribedbyTextId">
    <your-subscriptions
        [ariaDescribedbyTextId]="accountCredentialsyourSubsModalAriaDescribedbyTextId"
        [subscriptions]="accountCredentialsAndLookupStepStateService.streamingSubscriptions$ | async"
        (actionClicked)="onSubscriptionAction($event)"
    ></your-subscriptions>
</sxm-ui-modal>

<sxm-ui-modal
    #verifyAccountModal
    [ariaDescribedbyTextId]="accountCredentialsModalAriaDescribedbyTextId"
    (modalClosed)="onVerifyAccountModalClose()"
    [title]="translateKeyPrefix + '.VERIFY_MODAL_TITLE' | translate"
    [titlePresent]="true"
    [showBackButton]="true"
    (backButton)="backToAccountFound()"
>
    <h5>{{ translateKeyPrefix + ".VERIFY_MODAL_HEADER_TITLE" | translate }}</h5>
    <p [id]="accountCredentialsModalAriaDescribedbyTextId">{{ translateKeyPrefix + ".VERIFY_MODAL_HEADER_COPY" | translate }}</p>
    <validate-lpz-form #lpzForm (verified)="onAccountVerified()" (invalidUserInfo)="onAccountInvalid()"></validate-lpz-form>
</sxm-ui-modal>
