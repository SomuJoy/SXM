<main de-care-page-main>
    <h4>{{ translateKeyPrefix + "TITLE" | translate }}</h4>
    <br />
    <p>{{ translateKeyPrefix + "INSTRUCTIONS" | translate }}</p>
    <br />

    <form [formGroup]="passwordForm" novalidate>
        <div *ngIf="showSystemError$ | async" class="invalid-feedback">
            <p>{{ translateKeyPrefix + "ERRORS.SYSTEM_ERROR" | translate }}</p>
        </div>

        <sxm-ui-password-strength
            formControlName="password"
            [labelText]="translateKeyPrefix + 'PASSWORD.LABEL' | translate"
            id="{{ passwordElementId }}"
            [reservedWords]="reservedWords"
            [alwaysDisplayPasswordHint]="alwaysDisplayPasswordHint"
            [class.invalid]="passwordForm.controls.password | formControlInvalid: submitted"
            #passwordControl
        >
        </sxm-ui-password-strength>

        <div *ngIf="passwordForm.controls.password | formControlInvalid: submitted" class="invalid-feedback">
            <p *ngIf="passwordForm.controls.password.hasError('required')">
                {{ translateKeyPrefix + "PASSWORD.ERRORS.REQUIRED" | translate }}
            </p>
            <p *ngIf="passwordForm.controls.password.hasError('length')">
                {{ translateKeyPrefix + "PASSWORD.ERRORS.GENERIC" | translate: passwordForm.controls.password.errors.length }}
            </p>
            <p *ngIf="passwordForm.controls.password.hasError('policy')">
                {{ translateKeyPrefix + "PASSWORD.ERRORS.GENERIC" | translate }}
            </p>
            <p *ngIf="passwordForm.controls.password.hasError('generic')">
                {{ translateKeyPrefix + "PASSWORD.ERRORS.GENERIC" | translate }}
            </p>
            <p *ngIf="passwordForm.controls.password.errors?.reservedWords as reservedWordsError">
                {{
                    translateKeyPrefix + "PASSWORD.ERRORS.RESERVED_WORDS"
                        | translate
                            : {
                                  pluralWord: reservedWordsError.words.length | i18nPlural: (translateKeyPrefix + "PLURAL_MAP.WORD" | translate),
                                  reservedWords: reservedWordsError.words.join(", ")
                              }
                }}
            </p>
        </div>

        <div *ngIf="showExpiredTokenError$ | async" class="invalid-feedback">
            <p>{{ translateKeyPrefix + "ERRORS.EXPIRED_PASSWORD_RESET_TOKEN_ERROR" | translate }}</p>
        </div>
        <div *ngIf="showInvalidTokenError$ | async" class="invalid-feedback">
            <p>{{ translateKeyPrefix + "ERRORS.INVALID_PASSWORD_RESET_TOKEN_ERROR" | translate }}</p>
        </div>

        <button
            type="button"
            (click)="onSubmit()"
            sxm-proceed-button
            [loading]="processing$ | async"
            (mouseenter)="mouseEnterOnContinueButton()"
            (mouseleave)="mouseLeaveOnContinueButton()"
        >
            {{ translateKeyPrefix + "CONTINUE_BUTTON_TEXT" | translate }}
        </button>
    </form>
</main>
