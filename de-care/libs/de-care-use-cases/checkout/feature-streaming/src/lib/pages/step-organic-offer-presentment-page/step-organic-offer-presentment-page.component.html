<ng-container *ngrxLet="offerViewModel$ as offerViewModel">
    <ng-container *ngIf="offerLoad$ | async as offerLoad">
        <section
            id="heroContent"
            *ngrxLet="campaignHeroViewModel$ as campaignHeroViewModel"
            [style.background-image]="campaignHeroViewModel?.heroBackgroundImageUrl ? 'url(' + campaignHeroViewModel?.heroBackgroundImageUrl + ')' : ''"
        >
            <img
                *ngIf="campaignHeroViewModel?.heroForegroundImageUrl"
                [src]="campaignHeroViewModel.heroForegroundImageUrl"
                [attr.alt]="campaignHeroViewModel.heroImageAltText"
            />
        </section>
        <section id="mainContent">
            <ng-container *ngIf="offerLoad.pending || offerLoad.error">
                <article id="skeletonLoaderOfferCard">
                    <div class="shadow-helper">
                        <sxm-ui-primary-package-card-skeleton-loader></sxm-ui-primary-package-card-skeleton-loader>
                    </div>
                    <sxm-ui-button-cta-skeleton-loader></sxm-ui-button-cta-skeleton-loader>
                </article>
            </ng-container>
            <ng-container *ngIf="offerLoad.value">
                <div data-test="offer-with-deal" class="offer-with-deal" *ngIf="offerViewModel.useOfferWithDealPresentment; else defaultPackageCard">
                    <sxm-ui-package-card-basic
                        [packageData]="{
                            platformPlan: offerViewModel.offerDescription?.platformPlan,
                            priceAndTermDescTitle: offerViewModel.offerDescription?.priceAndTermDescTitle,
                            processingFeeDisclaimer: offerViewModel.offerDescription?.processingFeeDisclaimer
                        }"
                        [class.theme-non-retail]="offerViewModel.offerDescription?.nonRetailMode"
                    ></sxm-ui-package-card-basic>
                    <sxm-ui-product-banner
                        [data]="{
                            text: offerViewModel.offerDealCopy[0].title,
                            imageUrl: offerViewModel.offerDealCopy[0].partnerImage
                        }"
                    ></sxm-ui-product-banner>

                    <sxm-ui-accordion-chevron
                        [collapsedText]="translateKeyPrefix + '.VIEW_DETAILS_COLLAPSED' | translate"
                        [isInnerAccordion]="true"
                        [expandedText]="translateKeyPrefix + '.VIEW_DETAILS_EXPANDED' | translate"
                        [opened]="offerViewModel.offerDescription.openLeadOfferDetails"
                        data-test="PrimaryPackageDetailsAccordion"
                        sxmUiDataClickTrack="ui"
                        data-link-key="explore-more"
                    >
                        <sxm-ui-features-list
                            [data]="{
                                features: offerViewModel.offerDescription.details,
                                planName: offerViewModel.offerDescription.platformPlan
                            }"
                        ></sxm-ui-features-list>
                    </sxm-ui-accordion-chevron>
                </div>
                <ng-template #defaultPackageCard>
                    <div class="shadow-helper">
                        <sxm-ui-primary-package-card
                            [class.theme-non-retail]="offerViewModel?.offerDescription?.theme === 'Theme2'"
                            [class.presentation-no-icons-single-detail-visible]="offerViewModel?.offerDescription?.presentation === 'Presentation3'"
                            [packageData]="offerViewModel?.offerDescription"
                        ></sxm-ui-primary-package-card>
                    </div>
                </ng-template>
                <a
                    class="button primary full-width"
                    data-test="continueButton"
                    [routerLink]="pageStepRouteConfiguration.routeUrlNext"
                    queryParamsHandling="preserve"
                    sxmUiDataClickTrack="routing"
                >
                    {{ translateKeyPrefix + ".CONTINUE_BUTTON_TEXT" | translate }}
                </a>
            </ng-container>
        </section>
        <section id="legalCopySection" deCarePageFullWidthContent="fullWidthContent">
            <div *ngIf="offerLoad.value" [innerHTML]="offerViewModel.legalCopy"></div>
            <div *ngIf="offerLoad.pending">
                <sxm-ui-skeleton-loader-text-copy></sxm-ui-skeleton-loader-text-copy>
            </div>
        </section>
        <fallback-alert [displayLoader]="displayFallbackLoader$ | async" [fallbackReason]="fallbackReason$ | async"></fallback-alert>
    </ng-container>
</ng-container>
