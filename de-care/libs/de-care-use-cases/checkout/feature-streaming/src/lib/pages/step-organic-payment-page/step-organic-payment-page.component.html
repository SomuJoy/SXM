<ng-container *ngrxLet="organicPaymentViewModel$ as organicPaymentViewModel">
    <section id="mainContent">
        <sxm-ui-alert-pill *ngIf="organicPaymentViewModel?.showAlternateOfferAlert" class="streaming-eligibility black-alert-icon-notification rounded-corners">
            <p class="pill-text" [innerHTML]="translateKeyPrefix + '.OFFER_FOR_NEW_SUBSCRIBERS' | translate"></p>
        </sxm-ui-alert-pill>
        <sxm-ui-step-header [currentStepNumber]="pageStepRouteConfiguration.currentStepNumber" [numberOfSteps]="pageStepRouteConfiguration.totalNumberOfSteps">
            <ng-container title>{{ translateKeyPrefix + ".TITLE" | translate }}</ng-container>
            <ng-container body>
                <p data-test="bodyTitle" *ngIf="organicPaymentViewModel?.paymentPostTrialViewModel as data; else default">
                    {{
                        translateKeyPrefix + ".BODY.POST_TRIAL_" + data.type
                            | translate
                                : {
                                      trialEndDate: data.trialEndDate | sxmDate: (translationsForComponentService.currentLang$ | async)
                                  }
                    }}
                </p>
                <ng-template #default>
                    <p *ngIf="organicPaymentViewModel.showCancelAnytimeTextCopy || isCountryUS">
                        {{ translateKeyPrefix + ".BODY.CANCEL_ANYTIME" | translate }}
                    </p>
                </ng-template>
            </ng-container>
        </sxm-ui-step-header>
        <de-care-term-upsell-form *ngIf="organicPaymentViewModel?.termUpsellIsAvailable"></de-care-term-upsell-form>
        <sxm-ui-plan-recap-card
            *ngIf="!organicPaymentViewModel?.termUpsellIsAvailable && organicPaymentViewModel?.longDescriptionPlanRecapCardViewModel"
            [data]="organicPaymentViewModel.longDescriptionPlanRecapCardViewModel"
        ></sxm-ui-plan-recap-card>
        <div class="user-info" *ngIf="organicPaymentViewModel.streamingServiceMaskedUsername">
            <p class="masked-username-label">{{ translateKeyPrefix + ".EMAIL/USERNAME" | translate }}</p>
            <p>{{ organicPaymentViewModel.streamingServiceMaskedUsername }}</p>
        </div>
        <ng-container [ngSwitch]="organicPaymentViewModel?.paymentFormMode">
            <de-care-account-info-and-payment-info-form
                *ngSwitchCase="'FULL'"
                [country]="countrySettings.countryCode"
                [initialState]="organicPaymentViewModel?.paymentFormInitialState"
                (formCompleted)="onPaymentInfoCollected($event)"
            ></de-care-account-info-and-payment-info-form>
            <de-care-payment-info-basic-form
                *ngSwitchCase="'IDENTIFIED_USER'"
                [options]="{
                    countryCode: countrySettings.countryCode
                }"
                [initialState]="organicPaymentViewModel?.paymentFormInitialState"
                (formCompleted)="onPaymentInfoCollected($event)"
            ></de-care-payment-info-basic-form>
            <de-care-payment-info-with-phone-number-and-zip-form
                *ngSwitchCase="'IDENTIFIED_USER_BASIC'"
                [options]="{
                    countryCode: countrySettings.countryCode
                }"
                [initialState]="organicPaymentViewModel?.paymentFormInitialState"
                (formCompleted)="onPaymentInfoCollected($event)"
            ></de-care-payment-info-with-phone-number-and-zip-form>
            <de-care-payment-info-with-full-address-and-phone-form
                *ngSwitchCase="'IDENTIFIED_USER_FULL'"
                [options]="{
                    countryCode: countrySettings.countryCode
                }"
                [initialState]="organicPaymentViewModel?.paymentFormInitialState"
                (formCompleted)="onPaymentInfoCollected($event)"
            ></de-care-payment-info-with-full-address-and-phone-form>
            <de-care-account-info-basic-and-payment-info-form
                *ngSwitchDefault
                [country]="countrySettings.countryCode"
                [initialState]="organicPaymentViewModel?.paymentFormInitialState"
                (formCompleted)="onPaymentInfoCollected($event)"
            ></de-care-account-info-basic-and-payment-info-form>
        </ng-container>
        <sxm-ui-loading-with-alert-message
            *ngIf="displayIneligibleLoader$ | async"
            [isLoading]="true"
            [pillMessage]="translateKeyPrefix + '.INELIGIBLE_LOADING_ALERT' | translate"
            [paragraph]="translateKeyPrefix + '.INELIGIBLE_LOADING_BODY' | translate"
            (loadingCompleted)="onLoadingWithAlertMessageComplete($event)"
        ></sxm-ui-loading-with-alert-message>
    </section>
    <section *ngIf="organicPaymentViewModel?.offerInfoLegalCopy as legalCopy" id="legalCopySection" deCarePageFullWidthContent="fullWidthContent" data-test="offerLegalCopy">
        <div [innerHTML]="legalCopy"></div>
    </section>
</ng-container>
